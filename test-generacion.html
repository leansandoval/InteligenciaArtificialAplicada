<!DOCTYPE html>
<html>
<head>
    <title>Test Generaci√≥n de Flashcards</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Test Generaci√≥n de Flashcards Sin IA</h1>
    
    <div>
        <h3>Archivo de ejemplo:</h3>
        <input type="file" id="archivo" accept=".txt">
        <br><br>
        
        <button onclick="probarGeneracion()">üß™ Probar Generaci√≥n Tradicional</button>
        <br><br>
        
        <div id="resultado"></div>
        <div id="logs"></div>
    </div>

    <script>
        function log(mensaje) {
            console.log(mensaje);
            $('#logs').append('<div>' + mensaje + '</div>');
        }
        
        function probarGeneracion() {
            log('üîç Iniciando prueba de generaci√≥n...');
            
            const archivo = $('#archivo')[0].files[0];
            if (!archivo) {
                log('‚ùå Error: No se seleccion√≥ archivo');
                return;
            }
            
            log('üìÑ Archivo: ' + archivo.name + ' (' + archivo.size + ' bytes)');
            
            const formData = new FormData();
            formData.append('documento', archivo);
            formData.append('modo', 'traditional');
            
            // Configuraci√≥n tradicional por defecto
            formData.append('config.MaxCards', '10');
            formData.append('config.SplitByParagraph', 'true');
            formData.append('config.DetectQuestions', 'true');
            formData.append('config.UseStructural', 'true');
            formData.append('config.FilterShort', 'true');
            formData.append('config.CustomSeparator', '');
            
            log('üöÄ Enviando petici√≥n AJAX...');
            
            $.ajax({
                url: 'http://localhost:5291/Generacion/VistaPrevia',
                type: 'POST',
                data: formData,
                processData: false,
                contentType: false,
                success: function(response) {
                    log('‚úÖ Respuesta recibida: ' + JSON.stringify(response, null, 2));
                    $('#resultado').html('<pre>' + JSON.stringify(response, null, 2) + '</pre>');
                },
                error: function(xhr, status, error) {
                    log('‚ùå Error AJAX: ' + error);
                    log('üìã Status: ' + status);
                    log('üìÑ Response: ' + xhr.responseText);
                    $('#resultado').html('<pre>Error: ' + xhr.responseText + '</pre>');
                }
            });
        }
    </script>
</body>
</html>